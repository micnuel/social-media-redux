{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { client } from '../../api/client';\nexport const fetchNotifications = createAsyncThunk('notifications/fetchNotifications', async (_, {\n  getState\n}) => {\n  const allNotifications = selectAllNotifications(getState());\n  const [latestNotification] = allNotifications;\n  const latestTimestamp = latestNotification ? latestNotification.date : '';\n  const response = await client.get(`/fakeApi/notifications?since=${latestTimestamp}`);\n  return response.notifications;\n});\nconst notificationsSlice = createSlice({\n  name: 'notifications',\n  initialState: [],\n  reducers: {\n    allNotificationsRead(state, action) {\n      state.forEach(notification => {\n        notification.read = true;\n      });\n    }\n\n  },\n  extraReducers: {\n    [fetchNotifications.fulfilled]: (state, action) => {\n      state.forEach(notification => {\n        notification.isNew = !notification.read;\n      });\n      state.push(...action.payload);\n      state.sort((a, b) => b.date.localeCompare(a.date));\n    }\n  }\n});\nexport default notificationsSlice.reducer;\nexport const {\n  allNotificationsRead\n} = notificationsSlice.actions;\nexport const selectAllNotifications = state => state.notifications;","map":{"version":3,"sources":["/Users/emeka/Documents/Tutorials/Projects/redux-social/social-media-redux/redux-essentials-example-app/src/features/notifications/notificationsSlice.js"],"names":["createSlice","createAsyncThunk","client","fetchNotifications","_","getState","allNotifications","selectAllNotifications","latestNotification","latestTimestamp","date","response","get","notifications","notificationsSlice","name","initialState","reducers","allNotificationsRead","state","action","forEach","notification","read","extraReducers","fulfilled","isNew","push","payload","sort","a","b","localeCompare","reducer","actions"],"mappings":"AAAA,SAAQA,WAAR,EAAqBC,gBAArB,QAA4C,kBAA5C;AACA,SAAQC,MAAR,QAAqB,kBAArB;AAGA,OAAO,MAAMC,kBAAkB,GAAGF,gBAAgB,CAC9C,kCAD8C,EAE9C,OAAOG,CAAP,EAAU;AAACC,EAAAA;AAAD,CAAV,KAAwB;AACpB,QAAMC,gBAAgB,GAAGC,sBAAsB,CAACF,QAAQ,EAAT,CAA/C;AACA,QAAM,CAACG,kBAAD,IAAuBF,gBAA7B;AACA,QAAMG,eAAe,GAAGD,kBAAkB,GAACA,kBAAkB,CAACE,IAApB,GAA0B,EAApE;AACA,QAAMC,QAAQ,GAAG,MAAMT,MAAM,CAACU,GAAP,CAClB,gCAA+BH,eAAgB,EAD7B,CAAvB;AAKA,SAAOE,QAAQ,CAACE,aAAhB;AACF,CAZ4C,CAA3C;AAeP,MAAMC,kBAAkB,GAAGd,WAAW,CAAC;AACnCe,EAAAA,IAAI,EAAE,eAD6B;AAEnCC,EAAAA,YAAY,EAAC,EAFsB;AAGnCC,EAAAA,QAAQ,EAAC;AACLC,IAAAA,oBAAoB,CAACC,KAAD,EAAOC,MAAP,EAAc;AAC9BD,MAAAA,KAAK,CAACE,OAAN,CAAcC,YAAY,IAAG;AACzBA,QAAAA,YAAY,CAACC,IAAb,GAAmB,IAAnB;AACH,OAFD;AAGH;;AALI,GAH0B;AAUnCC,EAAAA,aAAa,EAAC;AACV,KAACrB,kBAAkB,CAACsB,SAApB,GAAgC,CAACN,KAAD,EAAOC,MAAP,KAAiB;AAC7CD,MAAAA,KAAK,CAACE,OAAN,CAAcC,YAAY,IAAG;AACzBA,QAAAA,YAAY,CAACI,KAAb,GAAoB,CAACJ,YAAY,CAACC,IAAlC;AACH,OAFD;AAGAJ,MAAAA,KAAK,CAACQ,IAAN,CAAW,GAAGP,MAAM,CAACQ,OAArB;AACAT,MAAAA,KAAK,CAACU,IAAN,CAAW,CAACC,CAAD,EAAGC,CAAH,KAASA,CAAC,CAACrB,IAAF,CAAOsB,aAAP,CAAqBF,CAAC,CAACpB,IAAvB,CAApB;AACH;AAPS;AAVqB,CAAD,CAAtC;AAqBA,eAAeI,kBAAkB,CAACmB,OAAlC;AACA,OAAO,MAAM;AAACf,EAAAA;AAAD,IAAyBJ,kBAAkB,CAACoB,OAAlD;AACP,OAAO,MAAM3B,sBAAsB,GAAGY,KAAK,IAAIA,KAAK,CAACN,aAA9C","sourcesContent":["import {createSlice, createAsyncThunk} from '@reduxjs/toolkit';\nimport {client} from '../../api/client';\n\n\nexport const fetchNotifications = createAsyncThunk(\n    'notifications/fetchNotifications',\n    async (_, {getState}) =>{\n        const allNotifications = selectAllNotifications(getState())\n        const [latestNotification] = allNotifications\n        const latestTimestamp = latestNotification?latestNotification.date: ''\n        const response = await client.get(\n            `/fakeApi/notifications?since=${latestTimestamp}`\n\n        )\n\n        return response.notifications\n     }\n)\n\nconst notificationsSlice = createSlice({\n    name: 'notifications',\n    initialState:[],\n    reducers:{\n        allNotificationsRead(state,action){\n            state.forEach(notification =>{\n                notification.read =true\n            })\n        }\n    },\n    extraReducers:{\n        [fetchNotifications.fulfilled]: (state,action) =>{\n            state.forEach(notification =>{\n                notification.isNew =!notification.read\n            })\n            state.push(...action.payload)\n            state.sort((a,b) => b.date.localeCompare(a.date))\n        }\n    }\n})\n\nexport default notificationsSlice.reducer\nexport const {allNotificationsRead} = notificationsSlice.actions\nexport const selectAllNotifications = state => state.notifications"]},"metadata":{},"sourceType":"module"}